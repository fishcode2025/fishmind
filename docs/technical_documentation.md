# FishMind 技术文档

## 项目概述

FishMind 是一个支持多种人工智能语言模型(LLM)的桌面客户端，可在 Windows、Mac 和 Linux 上使用。它提供了丰富的功能，让用户能够方便地与各种 AI 模型进行交互。

本项目使用 Tauri 作为桌面应用框架，React 作为前端框架，Material UI (MUI) 作为 UI 组件库。

## 技术栈

- **前端框架**: React
- **UI 组件库**: Material UI (MUI)
- **桌面应用框架**: Tauri
- **构建工具**: Vite
- **语言**: TypeScript, Rust (Tauri 后端)

## 开发步骤

### 1. 项目初始化与环境搭建
- 创建 Tauri + React 项目
- 安装并配置 MUI 依赖
- 设置基本项目结构

### 2. 设计应用布局与主题
- 创建主布局组件
- 实现深色/浅色主题切换
- 设计响应式布局

### 3. 实现导航系统
- 创建侧边导航栏
- 实现页面路由
- 设计顶部应用栏

### 4. 开发核心页面
- 主对话页面
- 助手管理页面
- 知识库页面
- 文件管理页面
- 翻译页面
- AI 绘画页面
- 设置页面

### 5. 实现 AI 对话功能
- 设计对话界面
- 实现消息输入与显示
- 支持 Markdown 渲染
- 添加代码高亮功能

### 6. 开发助手管理系统
- 创建助手列表组件
- 实现助手创建与编辑功能
- 设计助手分类与筛选

### 7. 实现文件处理功能
- 创建文件上传组件
- 设计文件预览界面
- 实现文件管理功能

### 8. 开发知识库功能
- 设计知识库界面
- 实现知识条目管理
- 添加搜索与筛选功能

### 9. 实现设置系统
- 创建设置界面
- 实现各种配置选项
- 添加 API 密钥管理

### 10. 添加额外功能
- 实现全局搜索
- 添加快捷弹出窗口
- 实现 Mermaid 图表支持

### 11. 优化用户体验
- 添加加载状态与动画
- 实现错误处理
- 优化响应速度

### 12. 与 Tauri 后端集成
- 实现前后端通信
- 添加文件系统访问
- 集成系统通知

## 项目结构

```
fishmind/
├── src/                      # React前端代码
│   ├── assets/               # 静态资源(图片、图标等)
│   │   └── ...
│   ├── components/           # 可复用组件
│   │   ├── common/           # 通用UI组件
│   │   ├── layout/           # 布局相关组件
│   │   ├── chat/             # 对话相关组件
│   │   ├── assistant/        # AI助手相关组件
│   │   ├── knowledge/        # 知识库相关组件
│   │   ├── file/             # 文件处理相关组件
│   │   ├── translation/      # 翻译相关组件
│   │   └── drawing/          # AI绘画相关组件
│   ├── pages/                # 应用页面
│   │   ├── Chat.tsx          # 主对话页面
│   │   ├── Assistants.tsx    # 助手管理页面
│   │   ├── Knowledge.tsx     # 知识库页面
│   │   ├── Files.tsx         # 文件管理页面
│   │   ├── Translation.tsx   # 翻译页面
│   │   ├── Drawing.tsx       # AI绘画页面
│   │   └── Settings.tsx      # 设置页面
│   ├── contexts/             # React上下文
│   │   ├── ThemeContext.tsx  # 主题上下文
│   │   ├── AuthContext.tsx   # 认证上下文
│   │   └── AIContext.tsx     # AI模型上下文
│   ├── hooks/                # 自定义钩子
│   ├── services/             # API服务和后端通信
│   ├── utils/                # 工具函数
│   ├── types/                # TypeScript类型定义
│   ├── theme/                # MUI主题配置
│   ├── App.tsx               # 主应用组件
│   ├── main.tsx              # 应用入口
│   └── routes.tsx            # 路由配置
├── src-tauri/                # Tauri后端代码
│   ├── src/                  # Rust代码
│   └── tauri.conf.json       # Tauri配置
├── public/                   # 公共资源
├── docs/                     # 项目文档
├── package.json              # npm配置
├── tsconfig.json             # TypeScript配置
└── vite.config.ts            # Vite配置
```

## 最佳实践

### 组件开发
- 使用函数组件和 React Hooks
- 将大型组件拆分为更小的可复用组件
- 使用 TypeScript 类型定义确保类型安全
- 使用 MUI 组件和主题系统保持 UI 一致性

### 状态管理
- 使用 React Context 管理全局状态
- 对于复杂状态，考虑使用 Redux 或 Zustand
- 将 API 调用逻辑与 UI 组件分离

### 样式管理
- 使用 MUI 的 `sx` 属性进行组件样式定制
- 使用 MUI 的主题系统实现一致的设计语言
- 实现深色/浅色主题切换功能

### 路由管理
- 使用 React Router 管理页面导航
- 实现嵌套路由以支持复杂页面结构
- 使用懒加载优化初始加载性能

### Tauri 集成
- 使用 Tauri API 进行文件系统操作
- 实现前后端通信机制
- 利用 Tauri 的系统集成功能

## 功能模块详细设计

### 1. 主对话界面
主对话界面是用户与 AI 交互的核心页面，包含以下组件：
- 侧边栏：显示助手列表和话题列表
- 对话区域：显示与 AI 的对话内容
- 输入区域：用于输入文本和上传文件
- 工具栏：提供各种操作按钮

### 2. 助手管理系统
助手管理系统允许用户创建和管理 AI 助手：
- 助手列表：显示所有可用的 AI 助手
- 助手创建表单：用于创建新的 AI 助手
- 助手编辑界面：用于编辑现有助手的设置

### 3. 知识库功能
知识库功能允许用户管理和查询知识条目：
- 知识库列表：显示所有知识库
- 条目管理界面：用于添加和编辑知识条目
- 搜索界面：用于搜索知识库内容

### 4. 文件管理功能
文件管理功能允许用户上传和管理文件：
- 文件浏览器：显示所有上传的文件
- 文件上传组件：用于上传新文件
- 文件预览界面：用于预览文件内容

### 5. 翻译功能
翻译功能提供多语言翻译能力：
- 语言选择器：用于选择源语言和目标语言
- 文本输入区域：用于输入要翻译的文本
- 翻译结果显示：显示翻译结果

### 6. AI 绘画功能
AI 绘画功能允许用户通过文本生成图像：
- 提示输入区域：用于输入图像描述
- 参数设置面板：用于调整生成参数
- 图像显示区域：显示生成的图像

### 7. 设置系统
设置系统允许用户配置应用行为：
- 常规设置：语言、主题等基本设置
- AI 提供商设置：配置 API 密钥和参数
- 界面设置：调整界面布局和行为
- 数据设置：管理数据存储和备份

## 开发规范

### 代码风格
- 使用 ESLint 和 Prettier 保持代码风格一致
- 遵循 React 和 TypeScript 的最佳实践
- 使用有意义的变量名和函数名

### 提交规范
- 使用语义化的提交消息
- 每个提交专注于单一功能或修复
- 定期提交代码，避免大型变更

### 文档规范
- 为所有组件和函数添加 JSDoc 注释
- 保持技术文档的更新
- 记录重要的设计决策和架构变更

## 性能优化策略

- 使用 React.memo 和 useMemo 减少不必要的重渲染
- 实现组件懒加载减少初始加载时间
- 优化大型列表渲染，考虑使用虚拟滚动
- 使用 Web Workers 处理计算密集型任务
- 实现请求缓存减少重复 API 调用 